#!/usr/bin/env bash
#
# center - center text and hide ui

# \e[?25h : show cursor
trap $'printf \e[?25h' EXIT

# \e[$nH : move to $n
# \e[6n  : query position
IFS='[;' read -rsp $'\e[999;999H\e[6n' -dR _ x y

fun() {
    printf -v string '%s%*s' "$string" $(((y + ${#2}) / 2)) "$2"
}

# center text
{ mapfile -C fun -c1 file < "$1"; } 2> /dev/null || {
    echo "usage : ${0##*/} [file]" >&2
    exit 1
}

# \e[2J   : clear screen
# \e[?25l : hide cursor
# \e[$nH  : move to $n
read -rst 10 -p $'\e[2J\e[?25l\e['"$(((x - ${#file[@]}) / 2 + 1))H$string"
