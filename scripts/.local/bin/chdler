#!/usr/bin/env bash
#
# download 4chan thread medias

(($#)) || {
    echo "usage : ${0##*/} [thread]" >&2
    exit 1
}

declare -A array

while read -rd \< line; do
    [[ $line =~ ('//is2.4chan.org/'[^\"]+) ]] &&
        array[http:${BASH_REMATCH[1]}]=1
done < <(curl -s "$1")

for file in "${!array[@]}"; {
    wget "$file" &> /dev/null &&
        echo "'${file##*/}' downloaded"
}
