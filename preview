#!/usr/bin/env bash
#
# center text and hide ui

if [[ ! -f $1 ]]; then
    echo 'usage : preview [file]'
    exit 1
fi

# enable sleep builtin
enable -f /usr/lib/bash/sleep sleep

# get terminal window size
shopt -s checkwinsize; (:;:)

# \e[H    : print in 0, 0
# \e[2J   : clear the screen
# \e[?25l : hide the cursor
# e\[?25h : show the cursor
printf '\e[2J\e[H\e[?25l'

trap "printf '\e[?25h'" INT EXIT

# center vertically
mapfile a < "$1"
for ((; i < (LINES - ${#a[@]}) / 2; i++)) { echo; }

# center horizontally
while read -r l; do
    printf '%*s\n' "$(((${#l} + COLUMNS) / 2))" "$l"
done < "$1"

sleep 10
