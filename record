#!/bin/sh
#
# record with ffmpeg

dir=~/pics/records
cur=$(date +%F_%H-%M-%S)

mkdir -p "$dir"

# get monitor resolution
bspc query -T -m | jq -r '
    [
         .rectangle.width
        ,.rectangle.height
    ] |
    @sh' |
    {
        read -r x y

        ffmpeg -loglevel error \
            -s "${x}x${y}" \
            -r 30 \
            -f x11grab \
            -i :0.0 \
            "$dir/$cur.mp4"
    }
